# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# LAPTOP Caddyfile â€” ~/caktus/caddy/Caddyfile
#
# Routing table (Host header â†’ container):
#   caktus.duckdns.org              â†’ caktus-landing:80    (project showcase)
#   hello.caktus.duckdns.org        â†’ caktus-hello:80      (smoke test)
#   portainer.caktus.duckdns.org    â†’ caktus-portainer:9000 (Docker UI)
#   status.caktus.duckdns.org       â†’ caktus-uptime:3001   (monitoring)
#
# Rules:
#  - auto_https off  â†’ TLS is handled upstream by VPS Caddy
#  - admin off       â†’ no Caddy admin API (attack surface reduction)
#  - All routing in one :80 block
#  - Named matchers (@name) for each app
#  - Always: reverse_proxy container-name:internal-port
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

{
    auto_https off
    admin off
}

:80 {

    # â”€â”€ Landing page (root domain) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    @landing host caktus.duckdns.org
    handle @landing {
        reverse_proxy caktus-landing:80
    }

    # â”€â”€ Hello World (smoke test) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    @hello host hello.caktus.duckdns.org
    handle @hello {
        reverse_proxy caktus-hello:80
    }

    # â”€â”€ Portainer (Docker UI) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    @portainer host portainer.caktus.duckdns.org
    handle @portainer {
        reverse_proxy caktus-portainer:9000
    }

    # â”€â”€ Uptime Kuma (status & monitoring) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # Note: Uptime Kuma requires WebSocket support. Caddy handles this natively.
    @uptime host status.caktus.duckdns.org
    handle @uptime {
        reverse_proxy caktus-uptime:3001
    }

    # â”€â”€ YOUR APPS GO HERE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # Run: bash scripts/add-app.sh myapp 3000 myimage:tag
    # It adds the 3-line block below automatically.
    #
    # @myapp host myapp.caktus.duckdns.org
    # handle @myapp {
    #     reverse_proxy caktus-myapp:3000
    # }

    # â”€â”€ Default (unmatched subdomain) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    handle {
        respond "ðŸŒµ Caktus â€” Unknown subdomain. Check your Caddyfile." 404
    }
}
